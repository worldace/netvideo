<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title></title>
  <style></style>
</head>
<body>
<video id="video" width="640" height="360" src="http://s3.amazonaws.com/ksr/assets/011/073/077/8f75bec4009be29cca885e2a950516e2_original.mp3" autoplay loop controls></video>

<form id="comment-form">
<input type="text" id="comment-input"><input type="submit" id="comment-button" value="コメント">
</form>

<script>
var $v = {};
$v.comment = {};


$v.comment.post = function(param){
    var body = "";
    for(var key in param){
        if(!param.hasOwnProperty(key)){ continue; }
        body += encodeURIComponent(key) + "=" + encodeURIComponent(param[key]) + "&";
    }

    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'commentpost.php');
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
    xhr.send(body);
};



document.addEventListener('DOMContentLoaded', function(){
    $v.comment.form   = document.getElementById("comment-form");
    $v.comment.input  = document.getElementById("comment-input");
    $v.comment.button = document.getElementById("comment-button");

    $v.comment.form.addEventListener('submit', function(event){
        event.preventDefault();

        var text = $v.comment.input.value.trim();
        if(text == ""){ return; }
        //二重投稿防止もここに欲しい
        //文字数制限
        
        $v.comment.post({text:text, time:"123456789"});
        $v.comment.input.value = "";
        $v.comment.input.focus();
    });
    
});






</script>


</body>
</html>